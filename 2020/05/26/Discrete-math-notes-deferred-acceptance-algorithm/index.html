<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Discrete math notes: deferred acceptance algorithm · Lydia Yuan's Blog</title><meta name="description" content="Discrete math notes: deferred acceptance algorithm - Lydia Yuan"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="Lydia Yuan's Blog"><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Lydia Yuan's Blog" type="application/atom+xml">
<!-- hexo-inject:begin --><!-- hexo-inject:end --></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">TAGS</a></li><li class="nav-list-item"><a href="https://github.com/YuanRuQian" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="mailto:lydiayuan99@protonmail.com" target="_self" class="nav-list-link">E-MAIL</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Discrete math notes: deferred acceptance algorithm</h1><div class="post-info">May 26, 2020</div><div class="post-content"><blockquote>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><p>Given an equal number of men and women to be paired for marriage, each man ranks all the women in order of his preference and each woman ranks all the men in order of her preference.</p>
<p>A stable set of engagements for marriage is one where no man prefers a woman over the one he is engaged to, where that other woman <em>also</em> prefers that man over the one she is engaged to. I.e. with consulting marriages, there would be no reason for the engagements between the people to change.</p>
<p><strong>Task Specifics</strong> Given ten males:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abe, bob, col, dan, ed, fred, gav, hal, ian, jon</span><br></pre></td></tr></table></figure>
<p>And ten females:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abi, bea, cath, dee, eve, fay, gay, hope, ivy, jan</span><br></pre></td></tr></table></figure>
<p>And a complete list of ranked preferences, where the most liked is to the left:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> abe: abi, eve, cath, ivy, jan, dee, fay, bea, hope, gay</span><br><span class="line"> bob: cath, hope, abi, dee, eve, fay, bea, jan, ivy, gay</span><br><span class="line"> col: hope, eve, abi, dee, bea, fay, ivy, gay, cath, jan</span><br><span class="line"> dan: ivy, fay, dee, gay, hope, eve, jan, bea, cath, abi</span><br><span class="line">  ed: jan, dee, bea, cath, fay, eve, abi, ivy, hope, gay</span><br><span class="line">fred: bea, abi, dee, gay, eve, ivy, cath, jan, hope, fay</span><br><span class="line"> gav: gay, eve, ivy, bea, cath, abi, dee, hope, jan, fay</span><br><span class="line"> hal: abi, eve, hope, fay, ivy, cath, jan, bea, gay, dee</span><br><span class="line"> ian: hope, cath, dee, gay, bea, abi, fay, ivy, jan, eve</span><br><span class="line"> jon: abi, fay, jan, gay, eve, bea, dee, cath, ivy, hope</span><br><span class="line">  </span><br><span class="line"> abi: bob, fred, jon, gav, ian, abe, dan, ed, col, hal</span><br><span class="line"> bea: bob, abe, col, fred, gav, dan, ian, ed, jon, hal</span><br><span class="line">cath: fred, bob, ed, gav, hal, col, ian, abe, dan, jon</span><br><span class="line"> dee: fred, jon, col, abe, ian, hal, gav, dan, bob, ed</span><br><span class="line"> eve: jon, hal, fred, dan, abe, gav, col, ed, ian, bob</span><br><span class="line"> fay: bob, abe, ed, ian, jon, dan, fred, gav, col, hal</span><br><span class="line"> gay: jon, gav, hal, fred, bob, abe, col, ed, dan, ian</span><br><span class="line">hope: gav, jon, bob, abe, ian, dan, hal, ed, col, fred</span><br><span class="line"> ivy: ian, col, hal, gav, fred, bob, abe, ed, jon, dan</span><br><span class="line"> jan: ed, hal, gav, abe, bob, jon, col, ian, fred, dan</span><br></pre></td></tr></table></figure>
<ol type="1">
<li>Use the Gale Shapley algorithm to find a stable set of engagements</li>
<li>Perturb this set of engagements to form an unstable set of engagements then check this new set for stability.</li>
</ol>
</blockquote>
<p>Please see this <a href="http://www.matrix67.com/blog/archives/2976" target="_blank" rel="noopener">post</a> for explanation</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.par = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.candidates = [];</span><br><span class="line">    <span class="keyword">this</span>.index = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.rank = <span class="function"><span class="keyword">function</span>(<span class="params">p</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.candidates.length; i++)</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.candidates[i] === p) <span class="keyword">return</span> i;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.prefers = <span class="function"><span class="keyword">function</span>(<span class="params">p</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.rank(p) &lt; <span class="keyword">this</span>.rank(<span class="keyword">this</span>.fiance);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.nextCandidate = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.index &gt;= <span class="keyword">this</span>.candidates.length) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.candidates[<span class="keyword">this</span>.index++];</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.engageTo = <span class="function"><span class="keyword">function</span>(<span class="params">p</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (p.fiance) p.fiance.fiance = <span class="literal">null</span>;</span><br><span class="line">        p.fiance = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.fiance) <span class="keyword">this</span>.fiance.fiance = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">this</span>.fiance = p;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.swapWith = <span class="function"><span class="keyword">function</span>(<span class="params">p</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%s &amp; %s swap partners"</span>, <span class="keyword">this</span>.name, p.name);</span><br><span class="line">        <span class="keyword">let</span> thisFiance = <span class="keyword">this</span>.fiance;</span><br><span class="line">        <span class="keyword">let</span>  pFiance = p.fiance;</span><br><span class="line">        <span class="keyword">this</span>.engageTo(pFiance);</span><br><span class="line">        p.engageTo(thisFiance);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isStable</span>(<span class="params">guys, gals</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; guys.length; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; gals.length; j++)</span><br><span class="line">            <span class="keyword">if</span> (guys[i].prefers(gals[j]) &amp;&amp; gals[j].prefers(guys[i]))</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">engageEveryone</span>(<span class="params">guys</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> done;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        done = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; guys.length; i++) &#123;</span><br><span class="line">            <span class="keyword">let</span> guy = guys[i];</span><br><span class="line">            <span class="keyword">if</span> (!guy.fiance) &#123;</span><br><span class="line">                done = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">let</span> gal = guy.nextCandidate();</span><br><span class="line">                <span class="keyword">if</span> (!gal.fiance || gal.prefers(guy))</span><br><span class="line">                    guy.engageTo(gal);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">while</span> (!done);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doMarriage</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> abe  = <span class="keyword">new</span> Person(<span class="string">"Abe"</span>);</span><br><span class="line">    <span class="keyword">let</span> bob  = <span class="keyword">new</span> Person(<span class="string">"Bob"</span>);</span><br><span class="line">    <span class="keyword">let</span> col  = <span class="keyword">new</span> Person(<span class="string">"Col"</span>);</span><br><span class="line">    <span class="keyword">let</span> dan  = <span class="keyword">new</span> Person(<span class="string">"Dan"</span>);</span><br><span class="line">    <span class="keyword">let</span> ed   = <span class="keyword">new</span> Person(<span class="string">"Ed"</span>);</span><br><span class="line">    <span class="keyword">let</span> fred = <span class="keyword">new</span> Person(<span class="string">"Fred"</span>);</span><br><span class="line">    <span class="keyword">let</span> gav  = <span class="keyword">new</span> Person(<span class="string">"Gav"</span>);</span><br><span class="line">    <span class="keyword">let</span> hal  = <span class="keyword">new</span> Person(<span class="string">"Hal"</span>);</span><br><span class="line">    <span class="keyword">let</span> ian  = <span class="keyword">new</span> Person(<span class="string">"Ian"</span>);</span><br><span class="line">    <span class="keyword">let</span> jon  = <span class="keyword">new</span> Person(<span class="string">"Jon"</span>);</span><br><span class="line">    <span class="keyword">let</span> abi  = <span class="keyword">new</span> Person(<span class="string">"Abi"</span>);</span><br><span class="line">    <span class="keyword">let</span> bea  = <span class="keyword">new</span> Person(<span class="string">"Bea"</span>);</span><br><span class="line">    <span class="keyword">let</span> cath = <span class="keyword">new</span> Person(<span class="string">"Cath"</span>);</span><br><span class="line">    <span class="keyword">let</span> dee  = <span class="keyword">new</span> Person(<span class="string">"Dee"</span>);</span><br><span class="line">    <span class="keyword">let</span> eve  = <span class="keyword">new</span> Person(<span class="string">"Eve"</span>);</span><br><span class="line">    <span class="keyword">let</span> fay  = <span class="keyword">new</span> Person(<span class="string">"Fay"</span>);</span><br><span class="line">    <span class="keyword">let</span> gay  = <span class="keyword">new</span> Person(<span class="string">"Gay"</span>);</span><br><span class="line">    <span class="keyword">let</span> hope = <span class="keyword">new</span> Person(<span class="string">"Hope"</span>);</span><br><span class="line">    <span class="keyword">let</span> ivy  = <span class="keyword">new</span> Person(<span class="string">"Ivy"</span>);</span><br><span class="line">    <span class="keyword">let</span> jan  = <span class="keyword">new</span> Person(<span class="string">"Jan"</span>);</span><br><span class="line"></span><br><span class="line">    abe.candidates  = [abi, eve, cath, ivy, jan, dee, fay, bea, hope, gay];</span><br><span class="line">    bob.candidates  = [cath, hope, abi, dee, eve, fay, bea, jan, ivy, gay];</span><br><span class="line">    col.candidates  = [hope, eve, abi, dee, bea, fay, ivy, gay, cath, jan];</span><br><span class="line">    dan.candidates  = [ivy, fay, dee, gay, hope, eve, jan, bea, cath, abi];</span><br><span class="line">    ed.candidates   = [jan, dee, bea, cath, fay, eve, abi, ivy, hope, gay];</span><br><span class="line">    fred.candidates = [bea, abi, dee, gay, eve, ivy, cath, jan, hope, fay];</span><br><span class="line">    gav.candidates  = [gay, eve, ivy, bea, cath, abi, dee, hope, jan, fay];</span><br><span class="line">    hal.candidates  = [abi, eve, hope, fay, ivy, cath, jan, bea, gay, dee];</span><br><span class="line">    ian.candidates  = [hope, cath, dee, gay, bea, abi, fay, ivy, jan, eve];</span><br><span class="line">    jon.candidates  = [abi, fay, jan, gay, eve, bea, dee, cath, ivy, hope];</span><br><span class="line">    abi.candidates  = [bob, fred, jon, gav, ian, abe, dan, ed, col, hal];</span><br><span class="line">    bea.candidates  = [bob, abe, col, fred, gav, dan, ian, ed, jon, hal];</span><br><span class="line">    cath.candidates = [fred, bob, ed, gav, hal, col, ian, abe, dan, jon];</span><br><span class="line">    dee.candidates  = [fred, jon, col, abe, ian, hal, gav, dan, bob, ed];</span><br><span class="line">    eve.candidates  = [jon, hal, fred, dan, abe, gav, col, ed, ian, bob];</span><br><span class="line">    fay.candidates  = [bob, abe, ed, ian, jon, dan, fred, gav, col, hal];</span><br><span class="line">    gay.candidates  = [jon, gav, hal, fred, bob, abe, col, ed, dan, ian];</span><br><span class="line">    hope.candidates = [gav, jon, bob, abe, ian, dan, hal, ed, col, fred];</span><br><span class="line">    ivy.candidates  = [ian, col, hal, gav, fred, bob, abe, ed, jon, dan];</span><br><span class="line">    jan.candidates  = [ed, hal, gav, abe, bob, jon, col, ian, fred, dan];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> guys = [abe, bob, col, dan, ed, fred, gav, hal, ian, jon];</span><br><span class="line">    <span class="keyword">let</span> gals = [abi, bea, cath, dee, eve, fay, gay, hope, ivy, jan];</span><br><span class="line"></span><br><span class="line">    engageEveryone(guys);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; guys.length; i++) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"%s is engaged to %s"</span>, guys[i].name, guys[i].fiance.name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Stable = %s"</span>, isStable(guys, gals) ? <span class="string">"Yes"</span> : <span class="string">"No"</span>);</span><br><span class="line">    jon.swapWith(fred);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Stable = %s"</span>, isStable(guys, gals) ? <span class="string">"Yes"</span> : <span class="string">"No"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">doMarriage();</span><br></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/2020/05/25/LeetCode-337-House-Robber-III/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'seansun';
var disqus_identifier = '2020/05/26/Discrete-math-notes-deferred-acceptance-algorithm/';
var disqus_title = 'Discrete math notes: deferred acceptance algorithm';
var disqus_url = 'http://yoursite.com/2020/05/26/Discrete-math-notes-deferred-acceptance-algorithm/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//seansun.disqus.com/count.js" async></script><div class="copyright"><p>© 2020 <a href="http://yoursite.com">Lydia Yuan</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-164777506-1",'auto');ga('send','pageview');</script><!-- hexo-inject:begin --><!-- hexo-inject:end --></body></html>