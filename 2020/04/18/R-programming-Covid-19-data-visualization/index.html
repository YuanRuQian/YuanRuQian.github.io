<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> R programming : Covid-19 data visualization · Lydia Yuan's Blog</title><meta name="description" content="R programming : Covid-19 data visualization - Lydia Yuan"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="Lydia Yuan's Blog"><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Lydia Yuan's Blog" type="application/atom+xml">
<!-- hexo-inject:begin --><!-- hexo-inject:end --></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">TAGS</a></li><li class="nav-list-item"><a href="https://github.com/YuanRuQian" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="mailto:lydiayuan99@protonmail.com" target="_self" class="nav-list-link">E-MAIL</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">R programming : Covid-19 data visualization</h1><div class="post-info">Apr 18, 2020</div><div class="post-content"><p>Here is the raw data :</p>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&gt; china</span><br><span class="line">            日期 新增确诊病例 新增死亡病例 新增治愈出院病例 新增疑似病例</span><br><span class="line"><span class="number">1</span>  <span class="number">2020</span>年<span class="number">1</span>月<span class="number">29</span>日         <span class="number">1737</span>           <span class="number">38</span>               <span class="number">21</span>         <span class="number">4148</span></span><br><span class="line"><span class="number">2</span>  <span class="number">2020</span>年<span class="number">1</span>月<span class="number">30</span>日         <span class="number">1982</span>           <span class="number">43</span>               <span class="number">47</span>         <span class="number">4812</span></span><br><span class="line"><span class="number">3</span>  <span class="number">2020</span>年<span class="number">1</span>月<span class="number">31</span>日         <span class="number">2102</span>           <span class="number">46</span>               <span class="number">73</span>         <span class="number">5019</span></span><br><span class="line"><span class="number">4</span>   <span class="number">2020</span>年<span class="number">2</span>月<span class="number">1</span>日         <span class="number">2590</span>           <span class="number">46</span>               <span class="number">85</span>         <span class="number">4562</span></span><br><span class="line"><span class="number">5</span>   <span class="number">2020</span>年<span class="number">2</span>月<span class="number">2</span>日         <span class="number">2829</span>           <span class="number">57</span>              <span class="number">147</span>         <span class="number">5173</span></span><br><span class="line"><span class="number">6</span>   <span class="number">2020</span>年<span class="number">2</span>月<span class="number">3</span>日         <span class="number">3235</span>           <span class="number">64</span>              <span class="number">157</span>         <span class="number">5072</span></span><br><span class="line"><span class="number">7</span>   <span class="number">2020</span>年<span class="number">2</span>月<span class="number">4</span>日         <span class="number">3887</span>           <span class="number">65</span>              <span class="number">262</span>         <span class="number">3971</span></span><br><span class="line"><span class="number">8</span>   <span class="number">2020</span>年<span class="number">2</span>月<span class="number">5</span>日         <span class="number">3694</span>           <span class="number">73</span>              <span class="number">261</span>         <span class="number">5328</span></span><br><span class="line"><span class="number">9</span>   <span class="number">2020</span>年<span class="number">2</span>月<span class="number">6</span>日         <span class="number">3143</span>           <span class="number">73</span>              <span class="number">387</span>         <span class="number">4833</span></span><br><span class="line"><span class="number">10</span>  <span class="number">2020</span>年<span class="number">2</span>月<span class="number">7</span>日         <span class="number">3399</span>           <span class="number">86</span>              <span class="number">510</span>         <span class="number">4214</span></span><br><span class="line"><span class="number">11</span>  <span class="number">2020</span>年<span class="number">2</span>月<span class="number">8</span>日         <span class="number">2656</span>           <span class="number">89</span>              <span class="number">600</span>         <span class="number">3916</span></span><br><span class="line"><span class="number">12</span>  <span class="number">2020</span>年<span class="number">2</span>月<span class="number">9</span>日         <span class="number">3062</span>           <span class="number">97</span>              <span class="number">632</span>         <span class="number">4008</span></span><br><span class="line"><span class="number">13</span> <span class="number">2020</span>年<span class="number">2</span>月<span class="number">10</span>日         <span class="number">2478</span>          <span class="number">108</span>              <span class="number">716</span>         <span class="number">3536</span></span><br><span class="line"><span class="number">14</span> <span class="number">2020</span>年<span class="number">2</span>月<span class="number">11</span>日         <span class="number">2015</span>           <span class="number">97</span>              <span class="number">744</span>         <span class="number">3342</span></span><br><span class="line"><span class="number">15</span> <span class="number">2020</span>年<span class="number">2</span>月<span class="number">12</span>日        <span class="number">15152</span>          <span class="number">254</span>             <span class="number">1171</span>         <span class="number">2807</span></span><br><span class="line"><span class="number">16</span> <span class="number">2020</span>年<span class="number">2</span>月<span class="number">13</span>日         <span class="number">5090</span>          <span class="number">121</span>             <span class="number">1081</span>         <span class="number">2450</span></span><br><span class="line"><span class="number">17</span> <span class="number">2020</span>年<span class="number">2</span>月<span class="number">14</span>日         <span class="number">2641</span>          <span class="number">143</span>             <span class="number">1373</span>         <span class="number">2277</span></span><br><span class="line"><span class="number">18</span> <span class="number">2020</span>年<span class="number">2</span>月<span class="number">15</span>日         <span class="number">2009</span>          <span class="number">142</span>             <span class="number">1323</span>         <span class="number">1918</span></span><br><span class="line"><span class="number">19</span> <span class="number">2020</span>年<span class="number">2</span>月<span class="number">16</span>日         <span class="number">2048</span>          <span class="number">105</span>             <span class="number">1425</span>         <span class="number">1563</span></span><br><span class="line"><span class="number">20</span> <span class="number">2020</span>年<span class="number">2</span>月<span class="number">17</span>日         <span class="number">1886</span>           <span class="number">98</span>             <span class="number">1701</span>         <span class="number">1432</span></span><br><span class="line"><span class="number">21</span> <span class="number">2020</span>年<span class="number">2</span>月<span class="number">18</span>日         <span class="number">1749</span>          <span class="number">136</span>             <span class="number">1824</span>         <span class="number">1185</span></span><br><span class="line"><span class="number">22</span> <span class="number">2020</span>年<span class="number">2</span>月<span class="number">19</span>日          <span class="number">394</span>          <span class="number">114</span>             <span class="number">1779</span>         <span class="number">1277</span></span><br><span class="line"><span class="number">23</span> <span class="number">2020</span>年<span class="number">2</span>月<span class="number">20</span>日          <span class="number">889</span>          <span class="number">118</span>             <span class="number">2109</span>         <span class="number">1614</span></span><br><span class="line">&gt; usa</span><br><span class="line">            地区 累计确诊 累计死亡</span><br><span class="line"><span class="number">1</span>       New York   <span class="number">223691</span>    <span class="number">12248</span></span><br><span class="line"><span class="number">2</span>     New Jersey    <span class="number">75317</span>     <span class="number">3518</span></span><br><span class="line"><span class="number">3</span>  Massachusetts    <span class="number">32181</span>     <span class="number">1245</span></span><br><span class="line"><span class="number">4</span>       Michigan    <span class="number">29263</span>     <span class="number">2093</span></span><br><span class="line"><span class="number">5</span>     California    <span class="number">28036</span>      <span class="number">965</span></span><br><span class="line"><span class="number">6</span>   Pennsylvania    <span class="number">27735</span>      <span class="number">707</span></span><br><span class="line"><span class="number">7</span>       Illinois    <span class="number">25734</span>     <span class="number">1072</span></span><br><span class="line"><span class="number">8</span>        Florida    <span class="number">23340</span>      <span class="number">668</span></span><br><span class="line"><span class="number">9</span>      Louisiana    <span class="number">22532</span>     <span class="number">1156</span></span><br><span class="line"><span class="number">10</span>         Texas    <span class="number">17216</span>      <span class="number">424</span></span><br></pre></td></tr></table></figure>
<p>Dealing with the Chinese date data :</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; as.Date(china$日期, format = <span class="string">"%Y年%m月%d日"</span>)</span><br><span class="line"> [<span class="number">1</span>] <span class="string">"2020-01-29"</span> <span class="string">"2020-01-30"</span> <span class="string">"2020-01-31"</span> <span class="string">"2020-02-01"</span> <span class="string">"2020-02-02"</span> <span class="string">"2020-02-03"</span></span><br><span class="line"> [<span class="number">7</span>] <span class="string">"2020-02-04"</span> <span class="string">"2020-02-05"</span> <span class="string">"2020-02-06"</span> <span class="string">"2020-02-07"</span> <span class="string">"2020-02-08"</span> <span class="string">"2020-02-09"</span></span><br><span class="line">[<span class="number">13</span>] <span class="string">"2020-02-10"</span> <span class="string">"2020-02-11"</span> <span class="string">"2020-02-12"</span> <span class="string">"2020-02-13"</span> <span class="string">"2020-02-14"</span> <span class="string">"2020-02-15"</span></span><br><span class="line">[<span class="number">19</span>] <span class="string">"2020-02-16"</span> <span class="string">"2020-02-17"</span> <span class="string">"2020-02-18"</span> <span class="string">"2020-02-19"</span> <span class="string">"2020-02-20"</span></span><br></pre></td></tr></table></figure>
<p>Bummer ! Chinese characters cannot be displayed in the graph !</p>
<p>As a OS X user, I put a Chinese-frendly font in the system font folder then load into the working environment .</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt; font_files()</span><br><span class="line">            path                       file                    family    face</span><br><span class="line"><span class="number">1</span> /Library/Fonts          Arial Unicode.ttf          Arial Unicode MS Regular</span><br><span class="line"><span class="number">2</span> /Library/Fonts  TaipeiSansTCBeta-Bold.ttf       Taipei Sans TC Beta    Bold</span><br><span class="line"><span class="number">3</span> /Library/Fonts TaipeiSansTCBeta-Light.ttf Taipei Sans TC Beta Light Regular</span><br><span class="line"><span class="number">4</span> /Library/Fonts       TaipeiSansTCBeta.ttf       Taipei Sans TC Beta Regular</span><br><span class="line">        version                  ps_name</span><br><span class="line"><span class="number">1</span> Version <span class="number">1.</span>01x           ArialUnicodeMS</span><br><span class="line"><span class="number">2</span> Version <span class="number">1.000</span>    TaipeiSansTCBeta-Bold</span><br><span class="line"><span class="number">3</span> Version <span class="number">1.000</span>   TaipeiSansTCBeta-Light</span><br><span class="line"><span class="number">4</span> Version <span class="number">1.000</span> TaipeiSansTCBeta-Regular</span><br><span class="line">&gt; par(family=<span class="string">'Taipei Sans TC Beta'</span>)</span><br></pre></td></tr></table></figure>
<p>Start to draw the first graph :</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; plot(china$新增确诊病例~as.Date(china$日期,<span class="string">"%Y年%m月%d日"</span>),type=<span class="string">'b'</span>,col=<span class="string">'#f94f5b'</span>,pch=<span class="number">2</span>,xlab=<span class="string">'日期'</span>,ylab=<span class="string">'病例数目'</span>,main=<span class="string">'国内疫情数据'</span>)</span><br><span class="line">&gt; points(as.Date(china$日期,<span class="string">"%Y年%m月%d日"</span>),china$新增死亡病例,col=<span class="string">'#df9f9f'</span>,pch=<span class="number">4</span>,type = <span class="string">'b'</span>)</span><br><span class="line">&gt; points(as.Date(china$日期,<span class="string">"%Y年%m月%d日"</span>),china$新增治愈出院病例,col=<span class="string">'#9a3e3e'</span>,pch=<span class="number">6</span>,type=<span class="string">'b'</span>)</span><br><span class="line">&gt; points(as.Date(china$日期,<span class="string">"%Y年%m月%d日"</span>),china$新增疑似病例,col=<span class="string">'#ce7676'</span>,pch=<span class="number">8</span>,type=<span class="string">'b'</span>)</span><br><span class="line">&gt; legend(<span class="string">'topright'</span>,c(<span class="string">'新增确诊病例'</span>,<span class="string">'新增死亡病例'</span>,<span class="string">'新增治愈出院病例'</span>,<span class="string">'新增疑似病例'</span>),col=c(<span class="string">'#f94f5b'</span>,<span class="string">'#df9f9f'</span>,<span class="string">'#9a3e3e'</span>,<span class="string">'#ce7676'</span>),pch=c(<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>))</span><br></pre></td></tr></table></figure>
<p><img src="https://imgur.com/3kwUfRu" /></p>
<p>Now draw two pie charts with fancy percent legend :</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; percent&lt;-round(<span class="number">100</span>*usa$累计确诊/sum(usa$累计确诊),<span class="number">2</span>) </span><br><span class="line">&gt; percent &lt;-paste(percent, <span class="string">"%"</span>, sep = <span class="string">""</span>) </span><br><span class="line">&gt; percent &lt;-paste(usa$地区,<span class="string">' '</span>,percent, sep = <span class="string">""</span>) </span><br><span class="line">&gt; percent</span><br><span class="line"> [<span class="number">1</span>] <span class="string">"New York 44.29%"</span>     <span class="string">"New Jersey 14.91%"</span>   <span class="string">"Massachusetts 6.37%"</span></span><br><span class="line"> [<span class="number">4</span>] <span class="string">"Michigan 5.79%"</span>      <span class="string">"California 5.55%"</span>    <span class="string">"Pennsylvania 5.49%"</span> </span><br><span class="line"> [<span class="number">7</span>] <span class="string">"Illinois 5.1%"</span>       <span class="string">"Florida 4.62%"</span>       <span class="string">"Louisiana 4.46%"</span>    </span><br><span class="line">[<span class="number">10</span>] <span class="string">"Texas 3.41%"</span>  </span><br><span class="line">&gt; pie(usa$累计确诊,labels = percent,col = rainbow(length(usa$地区)))</span><br><span class="line">&gt; title(<span class="string">'美国各大州累计确诊数目'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://imgur.com/FdkQ5q9" /></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt; percent&lt;-round(<span class="number">100</span>*usa$累计死亡/sum(usa$累计死亡),<span class="number">2</span>) </span><br><span class="line">&gt; percent &lt;-paste(percent, <span class="string">"%"</span>, sep = <span class="string">""</span>) </span><br><span class="line">&gt; percent &lt;-paste(usa$地区,<span class="string">' '</span>,percent, sep = <span class="string">""</span>) </span><br><span class="line">&gt; percent</span><br><span class="line"> [<span class="number">1</span>] <span class="string">"New York 50.83%"</span>     <span class="string">"New Jersey 14.6%"</span>    <span class="string">"Massachusetts 5.17%"</span></span><br><span class="line"> [<span class="number">4</span>] <span class="string">"Michigan 8.69%"</span>      <span class="string">"California 4%"</span>       <span class="string">"Pennsylvania 2.93%"</span> </span><br><span class="line"> [<span class="number">7</span>] <span class="string">"Illinois 4.45%"</span>      <span class="string">"Florida 2.77%"</span>       <span class="string">"Louisiana 4.8%"</span>     </span><br><span class="line">[<span class="number">10</span>] <span class="string">"Texas 1.76%"</span></span><br></pre></td></tr></table></figure>
<p><img src="https://imgur.com/undefined" /></p>
<p>Now bar plot :</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; us &lt;- t(usa[,c(<span class="number">2</span>:<span class="number">3</span>)])</span><br><span class="line">&gt; us</span><br><span class="line">           [,<span class="number">1</span>]  [,<span class="number">2</span>]  [,<span class="number">3</span>]  [,<span class="number">4</span>]  [,<span class="number">5</span>]  [,<span class="number">6</span>]  [,<span class="number">7</span>]  [,<span class="number">8</span>]  [,<span class="number">9</span>] [,<span class="number">10</span>]</span><br><span class="line">累计确诊 <span class="number">223691</span> <span class="number">75317</span> <span class="number">32181</span> <span class="number">29263</span> <span class="number">28036</span> <span class="number">27735</span> <span class="number">25734</span> <span class="number">23340</span> <span class="number">22532</span> <span class="number">17216</span></span><br><span class="line">累计死亡  <span class="number">12248</span>  <span class="number">3518</span>  <span class="number">1245</span>  <span class="number">2093</span>   <span class="number">965</span>   <span class="number">707</span>  <span class="number">1072</span>   <span class="number">668</span>  <span class="number">1156</span>   <span class="number">424</span></span><br><span class="line">&gt; bp &lt;- barplot(us,beside=<span class="literal">TRUE</span>,names.arg = usa$地区,col=c(<span class="string">'#3b5998'</span>,<span class="string">'#8b9dc3'</span>),legend.text = c(<span class="string">'累计确诊'</span>,<span class="string">'累计死亡'</span>),main = <span class="string">'美国各大州累计确诊与死亡数据'</span>,ylim = c(<span class="number">0</span>,<span class="number">250000</span>))</span><br><span class="line">??? 怎么标数值？？？</span><br></pre></td></tr></table></figure>
<p><img src="" /></p>
<p>Now box plot :</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; boxplot(usa$累计确诊,usa$累计死亡,col=c(<span class="string">'#ffcc66'</span>),names = c(<span class="string">'累计确诊'</span>,<span class="string">'累计死亡'</span>))</span><br><span class="line">&gt; title(<span class="string">'美国累计确诊与累计死亡数据'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://imgur.com/B6C52sU" /></p>
</div></article></div></main><footer><div class="paginator"><a href="/2020/04/18/LeetCode-230-Kth-Smallest-Element-in-a-BST/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'seansun';
var disqus_identifier = '2020/04/18/R-programming-Covid-19-data-visualization/';
var disqus_title = 'R programming : Covid-19 data visualization';
var disqus_url = 'http://yoursite.com/2020/04/18/R-programming-Covid-19-data-visualization/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//seansun.disqus.com/count.js" async></script><div class="copyright"><p>© 2020 <a href="http://yoursite.com">Lydia Yuan</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end --></body></html>